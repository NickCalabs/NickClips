{% extends "layout.html" %}

{% block title %}Video Share - Upload or Share Videos{% endblock %}

{% block content %}
<div class="px-4 py-5 my-5 text-center">
    <h1 class="display-5 fw-bold">Share Your Videos</h1>
    <div class="col-lg-8 mx-auto">
        <p class="lead mb-4">
            Upload videos or share them from other platforms in seconds.
            Get a shareable link instantly.
        </p>
    </div>
</div>

<div class="row">
    <div class="col-md-10 mx-auto">
        <ul class="nav nav-tabs" id="uploadTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="upload-tab" data-bs-toggle="tab" data-bs-target="#upload-content" type="button" role="tab" aria-controls="upload-content" aria-selected="true">
                    <i class="fas fa-upload me-2"></i>Upload Video
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="link-tab" data-bs-toggle="tab" data-bs-target="#link-content" type="button" role="tab" aria-controls="link-content" aria-selected="false">
                    <i class="fas fa-link me-2"></i>From URL
                </button>
            </li>
        </ul>
        
        <div class="tab-content" id="uploadTabsContent">
            <!-- Upload Tab -->
            <div class="tab-pane fade show active" id="upload-content" role="tabpanel" aria-labelledby="upload-tab">
                <div class="p-4 bg-body-tertiary rounded-bottom">
                    <form id="upload-form" enctype="multipart/form-data">
                        <div class="upload-area" id="drop-area">
                            <i class="fas fa-cloud-upload-alt mb-3" style="font-size: 3rem;"></i>
                            <h4>Drag and drop your video file here</h4>
                            <p>or</p>
                            <div class="mb-3">
                                <input class="form-control" type="file" id="file-input" name="file" accept=".mp4,.mov,.avi,.mkv,.webm,.flv,.wmv">
                            </div>
                            <button type="submit" class="btn btn-primary px-4 py-2">
                                <i class="fas fa-upload me-2"></i>Upload Video
                            </button>
                            <p class="text-muted small mt-3">
                                Maximum file size: 1GB<br>
                                Supported formats: MP4, MOV, AVI, MKV, WEBM, FLV, WMV
                            </p>
                        </div>
                        
                        <div id="upload-progress" class="mt-4 d-none">
                            <div class="progress" style="height: 25px;">
                                <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
                            </div>
                            <p id="upload-status" class="text-center mt-2">Uploading...</p>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- URL Tab -->
            <div class="tab-pane fade" id="link-content" role="tabpanel" aria-labelledby="link-tab">
                <div class="p-4 bg-body-tertiary rounded-bottom">
                    <form id="download-form">
                        <div class="mb-3">
                            <label for="url-input" class="form-label">Video URL</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-link"></i></span>
                                <input type="url" class="form-control" id="url-input" placeholder="https://youtube.com/watch?v=..." required>
                                <button class="btn btn-primary" type="submit">Download</button>
                            </div>
                            <div class="form-text">
                                Enter a URL from YouTube, Twitter, Vimeo, and many other platforms.
                            </div>
                        </div>
                    </form>
                    
                    <div id="download-status" class="alert alert-info d-none"></div>
                    
                    <div class="mt-4">
                        <h5>Supported platforms include:</h5>
                        <div class="d-flex flex-wrap gap-2 mt-3">
                            <span class="badge text-bg-light border"><i class="fab fa-youtube me-1 text-danger"></i>YouTube</span>
                            <span class="badge text-bg-light border"><i class="fab fa-twitter me-1 text-info"></i>Twitter</span>
                            <span class="badge text-bg-light border"><i class="fab fa-vimeo me-1 text-primary"></i>Vimeo</span>
                            <span class="badge text-bg-light border"><i class="fab fa-facebook me-1 text-primary"></i>Facebook</span>
                            <span class="badge text-bg-light border"><i class="fab fa-instagram me-1 text-danger"></i>Instagram</span>
                            <span class="badge text-bg-light border"><i class="fab fa-tiktok me-1"></i>TikTok</span>
                            <span class="badge text-bg-light border"><i class="fab fa-twitch me-1 text-purple"></i>Twitch</span>
                            <span class="badge text-bg-light border"><i class="fab fa-reddit me-1 text-danger"></i>Reddit</span>
                            <span class="badge text-bg-light border"><i class="fas fa-ellipsis-h me-1"></i>Many more...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-5">
    <div class="col-md-4">
        <div class="text-center">
            <div class="feature-icon bg-primary text-white mb-3 p-3 rounded-circle mx-auto" style="width: 60px; height: 60px;">
                <i class="fas fa-bolt" style="font-size: 1.5rem;"></i>
            </div>
            <h3>Fast Processing</h3>
            <p>Videos are processed quickly and efficiently with a high-quality MP4 output.</p>
        </div>
    </div>
    <div class="col-md-4">
        <div class="text-center">
            <div class="feature-icon bg-primary text-white mb-3 p-3 rounded-circle mx-auto" style="width: 60px; height: 60px;">
                <i class="fas fa-share-alt" style="font-size: 1.5rem;"></i>
            </div>
            <h3>Easy Sharing</h3>
            <p>Get a short, easy-to-share link instantly, even before processing is complete.</p>
        </div>
    </div>
    <div class="col-md-4">
        <div class="text-center">
            <div class="feature-icon bg-primary text-white mb-3 p-3 rounded-circle mx-auto" style="width: 60px; height: 60px;">
                <i class="fas fa-laptop" style="font-size: 1.5rem;"></i>
            </div>
            <h3>Works Everywhere</h3>
            <p>Videos include proper preview tags for Discord, iMessage, and social media platforms.</p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Drag and drop handling
    const dropArea = document.getElementById('drop-area');
    const fileInput = document.getElementById('file-input');
    
    if (dropArea && fileInput) {
        // Prevent default drag behaviors
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });
        
        // Highlight drop area when item is dragged over it
        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });
        
        // Handle dropped files
        dropArea.addEventListener('drop', handleDrop, false);
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        function highlight() {
            dropArea.classList.add('highlight');
        }
        
        function unhighlight() {
            dropArea.classList.remove('highlight');
        }
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                fileInput.files = files;
                if (files[0].name) {
                    // Show the file name in the UI
                    const fileName = files[0].name;
                    dropArea.querySelector('h4').textContent = `Selected: ${fileName}`;
                }
            }
        }
    }
</script>
{% endblock %}
